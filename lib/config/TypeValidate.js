"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.validate=void 0;const e=t(require("url")),r=t(require("path")),s=require("./DefaultConfig"),i=require("../common/Constants"),n=new Map;n.set(s.types.REGISTRY,u),n.set(s.types.PUBLISH_ID,(function(t,e,r){return t.set(e,String(r)),""})),n.set(s.types.CACHE,l),n.set(s.types.KEY_PATH,l),n.set(s.types.NO_PROXY,(function(t,e,r){if(""===r)return t.set(e,r),"";if(!r||!0===r)return" - invalid no_proxy address.";return t.set(e,r),""})),n.set(s.types.HTTP_PROXY,o),n.set(s.types.HTTPS_PROXY,o),n.set(s.types.STRICT_SSL,(function(t,e,r){if(null!=r){const t=r;if(t.length>0&&'""'!==t&&"''"!==t&&f.test(t))return" - invalid strict_ssl value."}r=r instanceof Boolean?r.valueOf():"string"==typeof r?isNaN(Number(r))?"null"!==r&&"false"!==r&&'""'!==r:!!+r:!!r;return t.set(e,r),""})),n.set(s.types.LOG_LEVEL,(function(t,e,r){if(!r)return" - must be one of: error, warn, info, debug.";if(-1===s.logLevelType.indexOf(r.toLowerCase()))return" - must be one of: error, warn, info, debug.";return t.set(s.types.LOG_LEVEL,String(r.toLowerCase())),""})),n.set(s.types.PUBLISH_REGISTRY,(function(t,r,s){if(!s||""===s||!0===s)return' - full url with "http:// or "https://".';if(!s.startsWith("https://")&&!s.startsWith("http://"))return' - full url with "http:// or "https://".';const i=e.default.parse(String(s));if(!i.host)return' - full url with "http:// or "https://".';return t.set(r,i.href),""})),n.set(s.types.CA_FILES,(function(t,e,s){if(""===s)return t.set(e,s),"";if(!s||!0===s)return" - invalid CaFiles path.";if(s.endsWith(","))return" - invalid CaFiles path.";const i=s.split(",");let n=!1;if(i.forEach((t=>{t&&(r.default.isAbsolute(t)||(n=!0))})),n)return" - invalid CaFiles path.";return t.set(e,r.default.resolve(s)),""})),n.set(s.types.FETCH_TIMEOUT,(function(t,e,r){if(!r)return" - invalid fetch_timeout value.";if(isNaN(r))return" - invalid fetch_timeout value.";r<0&&(r=-r);return t.set(e,+r),""})),exports.validate=function(t,e,r){if(void 0===t)return"invalid data";if(!e)return"invalid key";if(n.has(e)){const s=n.get(e);if(void 0!==s)return s(t,e,r)}return e.startsWith("@")&&e.endsWith(":registry")?u(t,e,r):`Invalid key: ${e} - enter "${i.Constants.PM} config list -j" to get the defaults.`};function u(t,r,s){if(!s||""===s||!0===s)return' - full url with "http:// or "https://".';const i=s.split(",");let n="";for(const t of i){if(!t.startsWith("https://")&&!t.startsWith("http://"))return' - full url with "http:// or "https://".';const r=e.default.parse(String(t));if(!r.host)return' - full url with "http:// or "https://".';n=n.concat(r.href,",")}return t.set(r,n.substring(0,n.length-1)),""}function l(t,e,s){return""===s?(t.set(e,s),""):s&&!0!==s&&r.default.isAbsolute(s)?(t.set(e,r.default.resolve(s)),""):" - invalid filesystem path."}function o(t,r,s){if(""===s)return t.set(r,s),"";if(!s||!0===s||!s.startsWith("http://")&&!s.startsWith("https://"))return' - full url with "http://" or "https://".';const i=e.default.parse(String(s));return i.host?(t.set(r,i.href),""):' - full url with "http://" or "https://".'}const f=/[\u4E00-\u9FA5\uFE30-\uFFA0]/;